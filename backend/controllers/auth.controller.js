import bcrypt from "bcryptjs";
import User from "../models/user.model.js";
import generateTokenAndSetCookie from "../utils/generateToken.js";

export const signup = async (req, res) => {
  try {
    const { fullName, username, password, confirmPassword, gender } = req.body;

    if (password !== confirmPassword) {
      return res.status(400).json({ error: "Passwords Don't Match!" });
    }
    const user = await User.findOne({ username });

    if (user) {
      return res.status(400).json({ error: "Username Already Exists!" });
    }

    const salt = await bcrypt.genSalt(10);
    const hashedPassword = await bcrypt.hash(password, salt);

    const boyProfilePic =
      "data:image/png;base64,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";
    const girlProfilePic =
      "data:image/png;base64,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";

    const newUser = new User({
      fullName,
      username,
      password: hashedPassword,
      gender,
      profilePic: gender === "male" ? boyProfilePic : girlProfilePic,
    });

    if (newUser) {
      generateTokenAndSetCookie(newUser._id, res);
      await newUser.save();

      res.status(201).json({
        _id: newUser._id,
        fullName: newUser.fullName,
        username: newUser.username,
        profilePic: newUser.profilePic,
      });
    } else {
      res.status(400).json({ error: "Invalid User Data!" });
    }
  } catch (error) {
    console.log("Error in signup controller", error.message);
    res.status(500).json({ error: "Internal server error" });
  }
};

export const login = async (req, res) => {
  try {
    const { username, password } = req.body;
    const user = await User.findOne({ username });
    const isPasswordCorrect = await bcrypt.compare(
      password,
      user?.password || ""
    );

    if (!user || !isPasswordCorrect) {
      return res.status(400).json({ error: "Invalid Username Or Password!" });
    }

    generateTokenAndSetCookie(user._id, res);
    res.status(200).json({
      _id: user._id,
      fullName: user.fullName,
      username: user.username,
      profilePic: user.profilePic,
    });
  } catch (error) {
    console.log("Error in login controller", error.message);
    res.status(500).json({ error: "Internal server error" });
  }
};

export const logout = (req, res) => {
  try {
    res.cookie("jwt", "", { maxAge: 0 });
    res.status(200).json({ message: "Logged Out Successfully!" });
  } catch (error) {
    console.log("Error in logout controller", error.message);
    res.status(500).json({ error: "Internal server error" });
  }
};
